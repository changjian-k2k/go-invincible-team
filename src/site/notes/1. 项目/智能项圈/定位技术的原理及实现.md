---
{"dg-publish":true,"permalink":"/1. 项目/智能项圈/定位技术的原理及实现/","dgPassFrontmatter":true,"created":"2024-11-27T14:20:36.000+08:00","updated":"2024-12-20T10:51:58.573+08:00"}
---

每种定位的原理，以及实现方式。

![基于信号的定位技术的作用距离和精度.png](/img/user/1.%20%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E9%A1%B9%E5%9C%88/%E9%99%84%E4%BB%B6/%E5%9F%BA%E4%BA%8E%E4%BF%A1%E5%8F%B7%E7%9A%84%E5%AE%9A%E4%BD%8D%E6%8A%80%E6%9C%AF%E7%9A%84%E4%BD%9C%E7%94%A8%E8%B7%9D%E7%A6%BB%E5%92%8C%E7%B2%BE%E5%BA%A6.png)

# 卫星定位
全球导航卫星系统是一类导航系统的总称，这些导航系统使用在轨卫星发射无线电信号，进行被动测距来确定用户三维位置。**因此 GNSS 是一个自身定位系统，即在用户设备中计算定位解，用户设备计算位置结果，不需要发射任何信号**。
下图描述了卫星导航系统的结构，主要包括三部分：空间段、控制段和用户段。每一种GNSS都有自己独立的空间和控制段，而用户设备可以接收1、2或者多种GNSS信号。
![GNSS系统的结构.png](/img/user/1.%20%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E9%A1%B9%E5%9C%88/%E9%99%84%E4%BB%B6/GNSS%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%93%E6%9E%84.png)
- 空间段：包含众多卫星，通常称为星座（constellation），主要负责将信号广播给控制段和用户设备。每一个具备全球范围内的定位、导航等功能的星座，至少包含24颗卫星。
	- 为了给三维定位提供合适的信号几何分布，每个星座上的卫星必须分布在几个非平行的轨道平面上。因此，与地球同步卫星的赤道轨道相比较，GNSS轨道平面与赤道有一个倾角（对于GPS卫星而言，倾角为55°）。在较开阔的地方，在大多数时刻，可见的GPS卫星在5~14颗之间。
	- GNSS 卫星在几个频段上广播多种信号。广播的信号包含测距码和导航电文。
		- 用户设备使用测距码来确定所接收信号的发射时刻
		- 导航电文包含时间参数和卫星轨道的信息，使用这些信息就能够确定卫星的位置。
		- 每一颗卫星上的多个原子钟使得时间参考基准保持稳定。
- 控制段：包含一个监测站网、一或多个控制站和许多的上行注入站。
	- 监测站获取从卫星到监测站的测距信息，并将这些信息发送到控制站。监测站位于精确测定的位置点处，且有同步时钟，使用它们的测距信息可以确定卫星轨道并校正卫星的时钟。
	- 控制站计算每一颗卫星的导航电文信息，并且决定卫星是否需要执行变轨。
	- 注入站将控制站的指令发射给空间段。
- 用户段：包含天线、接收机、测距信息处理器和导航定位处理器。
	- 天线的功能是将输入的GNSS无线电信号转化成电信号，然后送给接收机，可以单独接收GPS信号，也可以同时接收其他GNSS信号。
	- 接收机使用时钟提供的时间参考基准，对天线提供的信号进行解调。
	- 测距处理器对接收机输出信号进行处理，即采用捕获和跟踪算法确定天线至所收到的每一颗卫星的距离，同时，也对接收机进行控制和对导航电文进行解码。
	- 导航处理器使用测距信息确定位置、速度和时间（PVT）结果。
## 信号与测距
大多数 GNSS 信号在电磁波频谱 1 ~ 2GHz 的 L 波段频域内进行广播。每一颗卫星发射几种频率的载波，通常情况下每一个频率上调制不同的信号。所有的 GNSS 信号均采用右手圆极化的方式。
GNSS信号包含一个载波、扩频码（测距码）和导航电文信息。扩频码和导航电文通过BPSK调制在载波上，扩频码和导航电文再通过简单相乘合并在一起。
一个BPSK调制的GNSS信号的幅度 $s$ 可以表示为：
$$s(t)\,=\,\sqrt{2P}C(t)D(t)cos(2\pi f_{ca}t+\phi_0)$$
其中：
- $P$ 为信号功率；
- $C$ 为扩频码，取值为 ±1；
- $D$ 为导航电文，取值为 ±1；
- $f_{ca}$ 为载波频率；
- $t$ 为时间；
- $\phi_0$ 为相位偏移；
例如，GNSS常用的粗捕获码，它的导航电文速率 $f_d$ 为 50 symbol/s，而扩频码速率 $f_{co}$ 为1.023Mchip/s。为了方便，我们通常用“符号”（symbol）来描述导航电文，用“码片”（chip）来描述扩频码。
扩频码由一伪随机噪声序列组成，该序列对接收机来说是已知的。在接收机中，输入的扩频谱信号与扩频码相乘，如果接收机产生的扩频码相位与输入信号的相位相匹配，就能将载波和导航电文恢复出来，这个过程叫做解扩处理。接收机并不知道接收到的GNSS信号扩频码的相位，所以接收机会不断调整扩频码的相位，直到与输入信号的乘积出现峰值。
![扩频信号的调制与解调.png](/img/user/1.%20%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E9%A1%B9%E5%9C%88/%E9%99%84%E4%BB%B6/%E6%89%A9%E9%A2%91%E4%BF%A1%E5%8F%B7%E7%9A%84%E8%B0%83%E5%88%B6%E4%B8%8E%E8%A7%A3%E8%B0%83.png)
通过相位差和信号频率，我们就能知道信号发射与接收的时间差$\Delta t = \tilde{t}^s_{sa,a} - \tilde{t}^s_{st,a}$ ，再乘以光速就可以得到原始的GNSS伪距测量值 $\tilde{\rho}^s_{a,R}$ 。因此，
$$\tilde{\rho}^s_{a,R} = (\tilde{t}^s_{sa,a} - \tilde{t}^s_{st,a}) c$$
其中忽略了误差源。另外，由于发射机和接收机时钟存在同步误差，伪距与真实距离是不同的。
在伪距未知时，就必须先通过接收机产生扩频码的所有相位进行搜索，直到发现相关峰值，这个过程称为信号的捕获（signal acquisition）。一旦完成GNSS信号的捕获，用户设备就切换到该信号的跟踪状态，此时可以根据前一时刻的伪距测量值进行伪距的预测，仅需要稍微改变接收机所产生扩频码的相位即可，这就是信号的跟踪（signal tracking）。对于大多数接收机来说，跟踪所要求信号的信噪比要比捕获所要求的低得多。
由于多普勒的影响，接收到的GNSS信号的载波频率是变化的，为了确保信号有效的解调，在捕获过程中同时也必须搜索信号的多普勒频移。
## 定位
使用单颗卫星的测距信息，用户的位置解是以卫星为球心半径为 $r$ 的球面，这就是一个位置面（surface of position, SOP）。使用两颗卫星的测距信息，用户的位置解是半径为 $r_{a1}$ 和 $r_{a2}$ 两个球的相交圆。若再增加第三个卫星的测距信息，用户的位置解就是相交圆的两个点上；大多数情况下，仅存在一个位置解，另外一个位置解可能在太空或地球内部而被排除；如果两个解都可行的话，则需要使用第四个测距值来解决定位解的模糊性。
![基于单、双和三测距信息定位解的轨迹.png](/img/user/1.%20%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E9%A1%B9%E5%9C%88/%E9%99%84%E4%BB%B6/%E5%9F%BA%E4%BA%8E%E5%8D%95%E3%80%81%E5%8F%8C%E5%92%8C%E4%B8%89%E6%B5%8B%E8%B7%9D%E4%BF%A1%E6%81%AF%E5%AE%9A%E4%BD%8D%E8%A7%A3%E7%9A%84%E8%BD%A8%E8%BF%B9.png)
但是，在GNSS系统中，接收机和卫星的时钟并不是同步的。因此产生的测距值为伪距，而不是距离。从卫星 $s$ 到用户天线 $a$ 的伪距为：
$$\rho^s_a = r_{as} + (\delta t_c^a - \delta t_c^s)c$$
式中： $r_{as}$ 为真实距离， $\delta t_c^a$ 为接收机的钟差；$\delta t_c^s$ 为卫星的钟差。
卫星的钟差由控制段来测量，并通过导航电文发射，因此导航处理器能够校正卫星钟差。
接收机的钟差是未知的，但是对于给定的接收机，对所有同时接收的伪距测量值，接收机钟差是一样的。因此它可以作为导航解的一部分和用户位置一起求解。
GNSS的导航解是四维的，包含三个位置和一个接收机钟差。四维导航解的求解，至少要求四个不同的GNSS卫星的测量值。正常的情况下，四个伪距球面不存在任何交叉点。但是，每一个伪距减去由于接收机钟差造成的距离误差 $\delta \rho^a_c = \delta t^a_c c$，那么半径等于实际距离的四个球面将相交于用户的位置点。因此，通过调整四个球的半径，且调整的大小相同，直到它们相交，就能够得到接收机钟差造成的距离误差 $\delta \rho^a_c$ 。
![基于四个伪距测量值的位置求解.png](/img/user/1.%20%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E9%A1%B9%E5%9C%88/%E9%99%84%E4%BB%B6/%E5%9F%BA%E4%BA%8E%E5%9B%9B%E4%B8%AA%E4%BC%AA%E8%B7%9D%E6%B5%8B%E9%87%8F%E5%80%BC%E7%9A%84%E4%BD%8D%E7%BD%AE%E6%B1%82%E8%A7%A3.png)
经过卫星钟差（以及其他已知误差）修正后的每个伪距测量值 $\tilde{\rho}^s_{a,C}$ ，可以表示为在信号发射时刻 $t^s_{st,a}$ 卫星的位置 $r^i_{is}$ 、在信号到达时刻 $t^s_{sa,a}$ 的用户天线位置 $r^i_{ia}$ 和接收机钟差所导致的测距误差 $\delta \rho^a_c$ 的函数（其中忽略了测量噪声）：
$$\tilde{\rho}^s_{a,C} = \sqrt{(r^i_{is}(t^s_{st,a}) - r^i_{ia}(t^s_{sa,a}))^T\,(r^i_{is}(t^s_{st,a}) - r^i_{ia}(t^s_{sa,a}))} + \delta \rho^a_c(t^s_{sa,a})$$
根据导航电文中广播的一系列描述卫星轨道的参数，称为星历（ephemeris），以及修正后的卫星型号发射时间测量值，就可以求解卫星的位置。如果信号的到达时间一样，那么对每颗卫星的伪距方程都是相同的，因此通过求解四个由伪距测量值所构成的瞬态方程，就可以得到四个未知量的解。
用同样的方法，采用一系列的伪距率测量值（伪距的变化率），可以求解用户天线的速度和接收机的钟差漂移。
![使用四颗卫星导航信号确定导航解示意图.png](/img/user/1.%20%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E9%A1%B9%E5%9C%88/%E9%99%84%E4%BB%B6/%E4%BD%BF%E7%94%A8%E5%9B%9B%E9%A2%97%E5%8D%AB%E6%98%9F%E5%AF%BC%E8%88%AA%E4%BF%A1%E5%8F%B7%E7%A1%AE%E5%AE%9A%E5%AF%BC%E8%88%AA%E8%A7%A3%E7%A4%BA%E6%84%8F%E5%9B%BE.png)
另外，除了导航和定位功能，GNSS也可用于授时服务，用来同步一个网络中的所有时钟。
## 误差源和性能的限制
GNSS导航解计算的误差源包含广播星历与真实星历间的误差和卫星钟差。信号传播延迟误差来源于信号在电离层和对流层中的折射，从而造成很大的测距误差。使用模型可以部分补偿电离层和对流层的延迟误差。如果一颗卫星使用多个频点的测距信息，那么还可以使用差分技术确定电离层导致的传播延迟误差。
接收机的测量误差是由于接收机动态响应延迟、接收机噪声、射频干扰及信号的多路径干扰而引起的。当GNSS信号被建筑物或地面反射时，接收到的信号多于一路，就出现了多路径现象。
![GNSS的基本误差.png](/img/user/1.%20%E9%A1%B9%E7%9B%AE/%E6%99%BA%E8%83%BD%E9%A1%B9%E5%9C%88/%E9%99%84%E4%BB%B6/GNSS%E7%9A%84%E5%9F%BA%E6%9C%AC%E8%AF%AF%E5%B7%AE.png)
通常来讲，大多数GNSS接收机会摈弃低于某一仰角的卫星信号，该仰角被称为屏蔽角，一般屏蔽角为5°~15°。因为低仰角的卫星信号存在着较大的电离层和对流层传播延迟，同时也易受多路径干扰。
在好的接收条件下，GNSS典型的定位精度为几米；如果可以使用一个或多个已知精确位置的参考基站提供的修正信息，也就是采用差分GNSS技术，定位精度可以改善到米级；如果采用载波相位差分技术可以进一步将定位精度提升到厘米级。
在一些恶劣的环境中，GNSS的性能会下降：
- GNSS信号可能被建筑物、地形和用户设备的载体遮挡，导致接收机接收到了较多的反射路径的信号；多路径和NLOS（nonline-of-sight，非视线）抵消技术可以提高GNSS在遮挡场景下的定位性能；
- 在室内或树下环境时，GNSS信号衰减严重，也会导致性能下降。
# 基站定位

# WIFI定位

# 蓝牙定位
